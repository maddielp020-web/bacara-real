<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Mesa de Bacar√° Cubano - FASE 4</title>
    <link rel="stylesheet" href="css/mesa.css">
</head>
<body>
    <div class="mesa-wrapper">
        <img src="img/mesa-fondo.png.jpg" alt="Mesa de Bacar√°" class="mesa-imagen">
        <div class="mesa-overlay" id="mesa-overlay">
            <!-- CAJ√ìN -->
            <div class="cajon-cartas" id="cajon-cartas">
                <div class="cartas-restantes" id="cartas-restantes">üÉè 416 cartas</div>
                <div class="estado-barajando" id="estado-barajando">‚ôªÔ∏è Barajando...</div>
            </div>

            <!-- CENTRAL -->
            <div class="area-central">
                <div class="mano-jugador" id="mano-corona">
                    <div class="carta-placeholder" id="carta1-corona">?</div>
                    <div class="carta-placeholder" id="carta2-corona">?</div>
                    <div class="puntuacion" id="puntuacion-corona">0</div>
                </div>
                <div class="mano-jugador" id="mano-retador">
                    <div class="carta-placeholder" id="carta1-retador">?</div>
                    <div class="carta-placeholder" id="carta2-retador">?</div>
                    <div class="puntuacion" id="puntuacion-retador">0</div>
                </div>
            </div>

            <!-- APUESTAS -->
            <div class="apuestas-zone">
                <button class="apostar-btn" onclick="apostar('corona', 100)">Apostar üëë</button>
                <button class="apostar-btn" onclick="apostar('retador', 100)">Apostar ‚öîÔ∏è</button>
            </div>

            <!-- ALERTAS -->
            <div class="comision-alert" id="comision-alert">-5% COMISI√ìN</div>
            
        </div>
    </div>

    <!-- JS M√ìDULOS -->
    <script src="js/mesa-cartas.js"></script>
    <script src="js/mesa-apuestas.js"></script>
    <script src="js/mesa-historial.js"></script>
    <script src="js/mesa-ui.js"></script>
    
    <script>
        // üöÄ INICIALIZAR
        window.addEventListener('load', function() {
            crearJugadores();
            simularPartida();
            console.log('üéÆ FASE 4 COMPLETA ‚úÖ');
        });

        function crearJugadores() {
            const overlay = document.getElementById('mesa-overlay');
            const jugadores = [
                {clase: 'jugador-leon', id: 'leon', avatar: 'ü¶Å', nombre: 'Le√≥n'},
                {clase: 'jugador-dragon', id: 'dragon', avatar: 'üêâ', nombre: 'Drag√≥n'},
                {clase: 'jugador-conejo', id: 'conejo', avatar: 'üê∞', nombre: 'Conejo'},
                {clase: 'jugador-aguila', id: 'aguila', avatar: 'ü¶Ö', nombre: '√Åguila'},
                {clase: 'jugador-cobra', id: 'cobra', avatar: 'üêç', nombre: 'Cobra'},
                {clase: 'jugador-buho', id: 'buho', avatar: 'ü¶â', nombre: 'B√∫ho'}
            ];
            
            jugadores.forEach(j => {
                const div = document.createElement('div');
                div.className = `jugador ${j.clase}`;
                div.innerHTML = `
                    <span class="corona-badge" id="corona-${j.id}">üëë CORONA</span>
                    <span class="retador-badge" id="retador-${j.id}">‚öîÔ∏è RETADOR</span>
                    <span class="jugador-avatar">${j.avatar}</span>
                    <div class="jugador-nombre">${j.nombre}</div>
                    <div class="jugador-fichas">
                        <span class="ficha-casino">ü™ô</span>
                        <span class="fichas-numero" data-jugador="${j.id}">1,250</span>
                    </div>
                `;
                overlay.appendChild(div);
            });
        }

        function simularPartida() {
    setInterval(() => {
        if (window.mesaCartas) window.mesaCartas.nuevaMano();
        if (window.mesaApuestas) {
            const ganador = Math.random() > 0.5 ? 'corona' : 'retador';
            window.procesarResultado(ganador);
            if (window.mesaUI?.mostrarReaccionesPorMano) {
                window.mesaUI.mostrarReaccionesPorMano(ganador);
            }
        }
        window.actualizarUICompleta();
    }, 5000);
}

        function apostar(destino, cantidad) {
            window.apostar(destino, cantidad);
        }
    </script>
</body>
</html>
